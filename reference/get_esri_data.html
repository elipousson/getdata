<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Use esri2sf to get data from an ArcGIS FeatureServer or MapServer for a location — get_esri_data • getdata</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Use esri2sf to get data from an ArcGIS FeatureServer or MapServer for a location — get_esri_data"><meta name="description" content="Wraps the esri2sf::esri2sf() and esri2sf::esri2df() functions to download
an ArcGIS FeatureServer or MapServer. Supports spatial filtering with
bounding box based on location and filtering by location name (if location
name column is provided). As of fall 2022, this package suggests the
elipousson/esri2sf fork using
httr2."><meta property="og:description" content="Wraps the esri2sf::esri2sf() and esri2sf::esri2df() functions to download
an ArcGIS FeatureServer or MapServer. Supports spatial filtering with
bounding box based on location and filtering by location name (if location
name column is provided). As of fall 2022, this package suggests the
elipousson/esri2sf fork using
httr2."><meta property="og:image" content="https://elipousson.github.io/getdata/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">getdata</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.1.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/elipousson/getdata/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Use esri2sf to get data from an ArcGIS FeatureServer or MapServer for a location</h1>
      <small class="dont-index">Source: <a href="https://github.com/elipousson/getdata/blob/main/R/get_esri_data.R" class="external-link"><code>R/get_esri_data.R</code></a></small>
      <div class="d-none name"><code>get_esri_data.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Wraps the <code><a href="https://rdrr.io/pkg/esri2sf/man/esri2sf.html" class="external-link">esri2sf::esri2sf()</a></code> and <code><a href="https://rdrr.io/pkg/esri2sf/man/esri2sf.html" class="external-link">esri2sf::esri2df()</a></code> functions to download
an ArcGIS FeatureServer or MapServer. Supports spatial filtering with
bounding box based on location and filtering by location name (if location
name column is provided). As of fall 2022, this package suggests the
<a href="https://github.com/elipousson/esri2sf/" class="external-link">elipousson/esri2sf</a> fork using
httr2.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">get_esri_data</span><span class="op">(</span></span>
<span>  <span class="va">url</span>,</span>
<span>  location <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  dist <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">getOption</a></span><span class="op">(</span><span class="st">"getdata.dist"</span><span class="op">)</span>,</span>
<span>  diag_ratio <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">getOption</a></span><span class="op">(</span><span class="st">"getdata.diag_ratio"</span><span class="op">)</span>,</span>
<span>  unit <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">getOption</a></span><span class="op">(</span><span class="st">"getdata.unit"</span><span class="op">)</span>,</span>
<span>  asp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">getOption</a></span><span class="op">(</span><span class="st">"getdata.asp"</span><span class="op">)</span>,</span>
<span>  crs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">getOption</a></span><span class="op">(</span><span class="st">"getdata.crs"</span>, <span class="fl">3857</span><span class="op">)</span>,</span>
<span>  where <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  name <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  name_col <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  coords <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  from_crs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">getOption</a></span><span class="op">(</span><span class="st">"getdata.crs"</span>, <span class="fl">4326</span><span class="op">)</span>,</span>
<span>  clean_names <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  token <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  progress <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  quiet <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  .name_repair <span class="op">=</span> <span class="fu">janitor</span><span class="fu">::</span><span class="va"><a href="https://sfirke.github.io/janitor/reference/make_clean_names.html" class="external-link">make_clean_names</a></span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">get_esri_layers</span><span class="op">(</span></span>
<span>  location <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  layers <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  url <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  nm <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  token <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  clean_names <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  quiet <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  .name_repair <span class="op">=</span> <span class="fu">janitor</span><span class="fu">::</span><span class="va"><a href="https://sfirke.github.io/janitor/reference/make_clean_names.html" class="external-link">make_clean_names</a></span>,</span>
<span>  <span class="va">...</span>,</span>
<span>  call <span class="op">=</span> <span class="fu">caller_env</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">get_esri_metadata</span><span class="op">(</span></span>
<span>  <span class="va">url</span>,</span>
<span>  token <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  meta <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  clean_names <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  .name_repair <span class="op">=</span> <span class="fu">janitor</span><span class="fu">::</span><span class="va"><a href="https://sfirke.github.io/janitor/reference/make_clean_names.html" class="external-link">make_clean_names</a></span>,</span>
<span>  call <span class="op">=</span> <span class="fu">caller_env</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-url">url<a class="anchor" aria-label="anchor" href="#arg-url"></a></dt>
<dd><p>FeatureServer or MapServer url to retrieve data from. Passed to
<code>url</code> parameter of <code><a href="https://rdrr.io/pkg/esri2sf/man/esri2sf.html" class="external-link">esri2sf::esri2sf()</a></code> or <code><a href="https://rdrr.io/pkg/esri2sf/man/esri2sf.html" class="external-link">esri2sf::esri2df()</a></code> functions.
For <code>get_esri_layers()</code>, the optional url must be a service url which is
the base url for one or more layer urls.</p></dd>


<dt id="arg-location">location<a class="anchor" aria-label="anchor" href="#arg-location"></a></dt>
<dd><p><code>sf</code>, <code>sfc</code>, or <code>bbox</code> object (or other object convertible
with <code>as_bbox()</code>. Optional.</p></dd>


<dt id="arg-dist">dist<a class="anchor" aria-label="anchor" href="#arg-dist"></a></dt>
<dd><p>buffer distance in units. Optional.</p></dd>


<dt id="arg-diag-ratio">diag_ratio<a class="anchor" aria-label="anchor" href="#arg-diag-ratio"></a></dt>
<dd><p>ratio of diagonal distance of area's bounding box used as
buffer distance. e.g. if the diagonal distance is 3000 meters and the
"diag_ratio = 0.1"  a 300 meter will be used. Ignored when <code>dist</code> is
provided.</p></dd>


<dt id="arg-unit">unit<a class="anchor" aria-label="anchor" href="#arg-unit"></a></dt>
<dd><p>Units for buffer. Supported options include "meter", "foot",
"kilometer", and "mile", "nautical mile" Common abbreviations (e.g. "km"
instead of "kilometer") are also supported. Distance in units is converted
to units matching GDAL units for x; defaults to "meter"</p></dd>


<dt id="arg-asp">asp<a class="anchor" aria-label="anchor" href="#arg-asp"></a></dt>
<dd><p>Aspect ratio of width to height as a numeric value (e.g. 0.33) or
character (e.g. "1:3"). If numeric, <code><a href="https://elipousson.github.io/sfext/reference/get_asp.html" class="external-link">get_asp()</a></code> returns the same value
without modification.</p></dd>


<dt id="arg-crs">crs<a class="anchor" aria-label="anchor" href="#arg-crs"></a></dt>
<dd><p>Cordinate reference system to return, Default: 4326 for
<code><a href="https://elipousson.github.io/sfext/reference/sf_to_df.html" class="external-link">sf_to_df()</a></code> and <code>NULL</code> for <code><a href="https://elipousson.github.io/sfext/reference/sf_to_df.html" class="external-link">df_to_sf()</a></code>.</p></dd>


<dt id="arg-where">where<a class="anchor" aria-label="anchor" href="#arg-where"></a></dt>
<dd><p>where query string passed to esri2sf, Default: <code>NULL</code></p></dd>


<dt id="arg-name-name-col">name, name_col<a class="anchor" aria-label="anchor" href="#arg-name-name-col"></a></dt>
<dd><p>Name value and name column found in the ArcGIS
FeatureServer or MapServer data.</p></dd>


<dt id="arg-coords">coords<a class="anchor" aria-label="anchor" href="#arg-coords"></a></dt>
<dd><p>Coordinate columns for input data.frame or output sf object (if
geometry is 'centroid' or 'point') Default: c("lon", "lat").</p></dd>


<dt id="arg-from-crs">from_crs<a class="anchor" aria-label="anchor" href="#arg-from-crs"></a></dt>
<dd><p>For <code><a href="https://elipousson.github.io/sfext/reference/sf_to_df.html" class="external-link">df_to_sf()</a></code>, coordinate reference system used by
coordinates or well known text in data frame.</p></dd>


<dt id="arg-clean-names">clean_names<a class="anchor" aria-label="anchor" href="#arg-clean-names"></a></dt>
<dd><p>If <code>TRUE</code>, set .name_repair to
<code><a href="https://sfirke.github.io/janitor/reference/make_clean_names.html" class="external-link">janitor::make_clean_names()</a></code> Ignored when <code>get_esri_metadata()</code> is not
returning a data.frame, e.g. <code>meta = "id"</code>.</p></dd>


<dt id="arg-token">token<a class="anchor" aria-label="anchor" href="#arg-token"></a></dt>
<dd><p>string for authentication token. defaults to <code>NULL</code>.</p></dd>


<dt id="arg-progress">progress<a class="anchor" aria-label="anchor" href="#arg-progress"></a></dt>
<dd><p>Show progress bar from <code><a href="https://cli.r-lib.org/reference/cli_progress_along.html" class="external-link">cli::cli_progress_along()</a></code> if <code>TRUE</code>.
Default <code>FALSE</code>.</p></dd>


<dt id="arg-quiet">quiet<a class="anchor" aria-label="anchor" href="#arg-quiet"></a></dt>
<dd><p>If <code>TRUE</code>, use <code><a href="https://rdrr.io/r/base/message.html" class="external-link">suppressMessages()</a></code> to prevent the printing of
messages about the requested layer. Defaults to <code>FALSE</code>.</p></dd>


<dt id="arg--name-repair">.name_repair<a class="anchor" aria-label="anchor" href="#arg--name-repair"></a></dt>
<dd><p>Defaults to "check_unique"</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Arguments passed on to <code><a href="https://rdrr.io/pkg/esri2sf/man/esri2sf.html" class="external-link">esri2sf::esri2sf</a></code></p><dl><dt><code>outFields</code></dt>
<dd><p>vector of fields you want to include. default is <code>NULL</code> for
all fields.</p></dd>

    <dt><code>replaceDomainInfo</code></dt>
<dd><p>If <code>TRUE</code>, add domain information to the return data
frame. Default <code>FALSE</code>.</p></dd>


</dl></dd>


<dt id="arg-layers">layers<a class="anchor" aria-label="anchor" href="#arg-layers"></a></dt>
<dd><p>Either a vector with URLs, a named list of urls, or a numeric
vector; defaults to <code>NULL</code>. Optional if url is a</p></dd>


<dt id="arg-nm">nm<a class="anchor" aria-label="anchor" href="#arg-nm"></a></dt>
<dd><p>Name or vector of names to add to the layers; defaults to <code>NULL</code>.</p></dd>


<dt id="arg-call">call<a class="anchor" aria-label="anchor" href="#arg-call"></a></dt>
<dd><p>The execution environment of a currently
running function, e.g. <code>caller_env()</code>. The function will be
mentioned in error messages as the source of the error. See the
<code>call</code> argument of <code><a href="https://rlang.r-lib.org/reference/abort.html" class="external-link">abort()</a></code> for more information.</p></dd>


<dt id="arg-meta">meta<a class="anchor" aria-label="anchor" href="#arg-meta"></a></dt>
<dd><p>Name of metadata list value to return from <a href="https://rdrr.io/pkg/esri2sf/man/esrimeta.html" class="external-link">esri2sf::esrimeta</a>,
e.g. "name" to return layer name. Defaults to <code>NULL</code>.</p></dd>

</dl></div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Eli Pousson.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

